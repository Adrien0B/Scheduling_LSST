import numpy as np
import matplotlib.pyplot as plt


Colors = ['b','m','orange','black','r','pink','yellow','cyan','g']

Ants2_x = np.array([[93.8,95.8,96.7,99.9,100.8,102.0,104.2,104.9,105.4,105.5,106.6,108.4],
                    [99.6, 101.7, 101.7, 102.8, 103.2, 103.2, 103.8, 106.2],
                    [100.8, 101.6, 102.4, 102.9, 103.5, 105.9, 106.7, 107.0],
                    [100.7, 106.3, 106.8, 107.0, 107.1, 107.2, 107.6, 108.2, 108.6, 108.8, 109.1, 111.1],
                    [99.7, 103.2, 105.6, 105.7, 105.8, 106.7, 107.0, 109.3, 109.7, 110.1],
                    [97.1, 100.1, 102.2, 104.2, 104.8, 106.7],
                    [96.4, 100.9, 103.4, 104.5, 105.2, 108.3, 108.3],
                    [98.6, 99.3, 100.4, 101.4, 103.2, 104.2, 105.9, 108.2],
                    [94.4, 97.6, 98.6, 101.0, 103.2, 103.8, 104.2, 104.5, 105.4, 106.3, 109.4],
                    [93.9, 99.8, 101.9, 105.3, 107.5, 108.9]])

Ants2_y = np.array([[1569.0,1543.0,1542.0,1503.0,1495.0,1490.0,1469.0,1452.0,1432.0,1415.0,1331.0,1324.0],
                    [1678.0, 1656.0, 1587.0, 1583.0, 1542.0, 1517.0, 1501.0, 1483.0],
                    [1550.0, 1460.0, 1453.0, 1439.0, 1434.0, 1422.0, 1359.0, 1332.0],
                    [1720.0, 1655.0, 1587.0, 1583.0, 1548.0, 1540.0, 1538.0, 1534.0, 1487.0, 1483.0, 1469.0, 1408.0],
                    [1592.0, 1567.0, 1499.0, 1465.0, 1454.0, 1430.0, 1416.0, 1402.0, 1317.0, 1290.0],
                    [1595.0, 1526.0, 1522.0, 1506.0, 1461.0, 1409.0],
                    [1706.0, 1694.0, 1680.0, 1667.0, 1626.0, 1608.0, 1513.0],
                    [1583.0, 1555.0, 1553.0, 1540.0, 1534.0, 1511.0, 1459.0, 1449.0],
                    [1681.0, 1652.0, 1611.0, 1598.0, 1578.0, 1534.0, 1461.0, 1450.0, 1382.0, 1375.0, 1351.0],
                    [1428.0, 1427.0, 1422.0, 1403.0, 1326.0, 1144.0]])


Ants5_x = np.array([[94.6,97.4,100.5,104.3,104.6,105.7,107.0,107.8,107.8,108.9],
                    [101.3, 101.4, 102.3, 102.7, 102.9, 104.6, 105.0, 105.3, 105.8, 106.4, 106.8, 107.2, 108.2, 108.4],
                    [97.3, 99.7, 103.5, 103.8, 105.0, 105.4, 105.7, 107.1, 108.0, 108.5, 109.3],
                    [101.6, 102.5, 103.7, 105.6, 106.6, 107.4, 107.5, 107.6, 107.9, 108.0, 110.0, 110.1, 110.4, 111.0,
                     111.1],
                    [101.4, 104.2, 106.2, 106.5, 107.4, 107.8, 108.0, 108.4, 110.0, 110.1],
                    [94.6, 99.0, 102.2, 102.2, 106.0, 106.1, 106.8, 107.4, 107.5, 107.8, 107.9, 108.1, 108.3, 108.7],
                    [94.4, 102.3, 104.8, 106.0, 106.1, 106.3, 106.9, 107.2, 107.9, 108.4, 109.1],
                    [97.1, 97.3, 97.8, 98.1, 99.4, 100.6, 101.2, 101.6, 101.8, 101.9, 102.2, 107.9, 108.6, 108.7, 108.7,
                     110.3],
                    [99.6, 100.9, 101.7, 102.8, 104.6, 104.9, 105.0, 107.0, 107.2, 107.7, 109.2, 110.4],
                    [92.5, 95.9, 98.0, 100.3, 101.6, 101.8, 104.3, 105.0, 105.8, 106.4, 107.7, 107.9, 108.9]])

Ants5_y = np.array([[1554.0,1535.0,1526.0,1525.0,1493.0,1429.0,1420.0,1418.0,1336.0,1315.0],
                    [1714.0, 1691.0, 1685.0, 1646.0, 1637.0, 1632.0, 1627.0, 1603.0, 1529.0, 1525.0, 1463.0, 1461.0,
                     1442.0, 1392.0],
                    [1637.0, 1633.0, 1577.0, 1553.0, 1543.0, 1452.0, 1433.0, 1415.0, 1411.0, 1342.0, 1323.0],
                    [1605.0, 1604.0, 1602.0, 1574.0, 1555.0, 1515.0, 1509.0, 1482.0, 1479.0, 1458.0, 1451.0, 1449.0,
                     1396.0, 1309.0, 1265.0],
                    [1463.0, 1409.0, 1386.0, 1340.0, 1276.0, 1245.0, 1232.0, 1219.0, 1163.0, 1120.0],
                    [1482.0, 1435.0, 1430.0, 1400.0, 1398.0, 1329.0, 1317.0, 1313.0, 1288.0, 1280.0, 1265.0, 1237.0,
                     1219.0, 1126.0],
                    [1637.0, 1618.0, 1572.0, 1566.0, 1557.0, 1541.0, 1514.0, 1512.0, 1475.0, 1461.0, 1453.0],
                    [1609.0, 1591.0, 1558.0, 1546.0, 1543.0, 1542.0, 1536.0, 1524.0, 1519.0, 1498.0, 1495.0, 1481.0,
                     1315.0, 1235.0, 1203.0, 1173.0],
                    [1597.0, 1568.0, 1553.0, 1538.0, 1523.0, 1507.0, 1501.0, 1490.0, 1470.0, 1424.0, 1419.0, 1373.0],
                    [1621.0, 1613.0, 1606.0, 1602.0, 1581.0, 1561.0, 1555.0, 1504.0, 1458.0, 1418.0, 1415.0, 1327.0,
                     1305.0]])


Ants10_x = np.array([[100.4,101.5,102.1,105.8,105.9,106.1,106.8,108.1,108.3,108.5],
                     [98.2, 99.6, 101.6, 101.8, 104.7, 104.7, 105.4, 106.6, 106.9, 107.7, 108.1, 108.4, 109.6, 110.5],
                     [97.1, 98.0, 101.3, 105.5, 105.6, 106.2, 106.4, 107.0, 107.7, 109.2, 109.5, 110.1, 110.9, 111.8],
                     [94.3, 101.7, 101.7, 102.5, 104.0, 104.4, 104.6, 104.7, 104.7, 105.4, 106.4, 106.9, 108.7, 109.8],
                     [95.2, 99.5, 101.0, 103.0, 103.4, 105.2, 105.7, 106.2, 106.9, 107.1, 107.2, 107.4, 107.5, 108.1,
                      108.2, 108.4, 108.5, 108.9, 109.0, 110.0],
                     [97.7, 100.4, 100.5, 102.2, 103.0, 103.4, 103.6, 105.0, 105.7, 106.5, 106.6, 107.2, 107.2, 107.4,
                      108.0, 108.1, 108.8, 109.7, 110.0],
                     [98.5, 101.0, 101.6, 102.7, 102.9, 103.0, 104.5, 105.6, 105.6, 105.7, 106.2, 106.2, 107.5, 108.3,
                      110.3],
                     [94.4, 99.2, 99.7, 102.6, 105.1, 105.4, 106.5, 107.8, 107.9, 108.1, 108.6, 110.4, 110.6],
                     [96.2, 98.4, 99.4, 100.2, 100.5, 100.7, 103.5, 103.6, 103.7, 103.9, 104.4, 105.5, 106.4, 107.1,
                      108.3, 108.6, 109.0, 109.4],
                     [96.5, 98.7, 101.7, 103.7, 104.1, 104.3, 105.3, 106.3, 107.0, 107.0, 107.8, 108.0, 109.8, 111.6]])

Ants10_y = np.array([[1689.0,1648.0,1642.0,1637.0,1553.0,1537.0,1515.0,1494.0,1486.0,1332.0],
                     [1778.0, 1742.0, 1734.0, 1678.0, 1670.0, 1630.0, 1627.0, 1599.0, 1573.0, 1568.0, 1544.0, 1504.0,
                      1492.0, 1371.0],
                     [1832.0, 1805.0, 1797.0, 1775.0, 1708.0, 1704.0, 1698.0, 1694.0, 1655.0, 1635.0, 1580.0, 1516.0,
                      1475.0, 1389.0],
                     [1913.0, 1901.0, 1875.0, 1859.0, 1820.0, 1789.0, 1776.0, 1775.0, 1746.0, 1741.0, 1735.0, 1681.0,
                      1659.0, 1490.0],
                     [1749.0, 1690.0, 1664.0, 1662.0, 1608.0, 1595.0, 1572.0, 1562.0, 1552.0, 1534.0, 1517.0, 1509.0,
                      1494.0, 1440.0, 1391.0, 1370.0, 1354.0, 1331.0, 1299.0, 1260.0],
                     [1692.0, 1691.0, 1689.0, 1674.0, 1648.0, 1647.0, 1633.0, 1630.0, 1616.0, 1591.0, 1583.0, 1572.0,
                      1536.0, 1503.0, 1500.0, 1487.0, 1468.0, 1466.0, 1417.0],
                     [1708.0, 1687.0, 1645.0, 1634.0, 1628.0, 1615.0, 1613.0, 1565.0, 1538.0, 1536.0, 1518.0, 1514.0,
                      1513.0, 1504.0, 1374.0],
                     [1666.0, 1652.0, 1641.0, 1636.0, 1607.0, 1563.0, 1559.0, 1537.0, 1503.0, 1501.0, 1490.0, 1455.0,
                      1351.0],
                     [1610.0, 1595.0, 1584.0, 1567.0, 1566.0, 1539.0, 1538.0, 1518.0, 1504.0, 1496.0, 1494.0, 1465.0,
                      1447.0, 1416.0, 1389.0, 1332.0, 1284.0, 1274.0],
                     [1812.0, 1723.0, 1703.0, 1658.0, 1643.0, 1637.0, 1623.0, 1602.0, 1561.0, 1554.0, 1548.0, 1511.0,
                      1496.0, 1348.0]])

Ants20_x = np.array([[105.4,106.7,106.8,107.2,107.4,107.7,107.9,108.4,108.9,109.5,109.6,110.4,110.5,110.8,111.7,112.0,115.6],
                     [97.0, 99.9, 104.0, 104.4, 104.5, 108.1, 109.2, 110.4, 110.9],
                     [93.0, 98.4, 99.4, 100.9, 102.9, 104.0, 105.7, 108.5, 108.8, 109.3, 110.6],
                     [94.6, 97.7, 100.5, 103.4, 103.5, 105.5, 105.7, 106.4, 106.9, 107.5, 108.2, 108.5, 108.6, 109.2,
                      109.5, 109.5, 109.5, 110.3, 110.5, 110.8],
                     [97.1, 103.5, 104.9, 104.9, 105.3, 106.7, 106.9, 107.3, 107.5, 107.6, 107.7, 108.0, 109.4, 109.5,
                      109.6],
                     [97.9, 97.9, 99.8, 100.8, 104.0, 104.8, 105.0, 105.5, 105.6, 105.9, 107.2, 107.5, 107.6, 107.6,
                      107.8, 107.8, 108.4, 109.3, 109.3, 109.6, 110.0, 110.0, 110.1],
                     [101.5, 102.1, 102.4, 105.4, 106.1, 107.2, 107.9, 109.2, 110.3, 110.7, 112.0, 113.4],
                     [98.9, 99.6, 102.0, 102.5, 104.0, 105.5, 105.9, 106.0, 106.7, 107.0, 107.9, 108.0, 109.4, 110.1,
                      110.7],
                     [99.8, 100.3, 100.5, 100.6, 101.3, 102.7, 103.2, 103.6, 105.4, 105.7, 105.8, 106.7, 107.3, 108.0,
                      108.3, 109.1, 109.1, 109.3],
                     [91.2, 97.7, 100.3, 100.9, 101.0, 102.6, 104.9, 105.4, 105.4, 105.5, 106.7, 107.0, 107.9, 107.9,
                      108.3, 108.6, 109.3]])

Ants20_y = np.array([[1809.0,1752.0,1744.0,1739.0,1721.0,1705.0,1704.0,1697.0,1686.0,1678.0,1667.0,1618.0,1579.0,1576.0,1565.0,1456.0,1445.0],
                     [1694.0, 1668.0, 1656.0, 1638.0, 1614.0, 1596.0, 1494.0, 1460.0, 1436.0],
                     [1654.0, 1649.0, 1643.0, 1619.0, 1603.0, 1592.0, 1577.0, 1548.0, 1474.0, 1462.0, 1303.0],
                     [1668.0, 1666.0, 1653.0, 1645.0, 1636.0, 1610.0, 1589.0, 1573.0, 1569.0, 1554.0, 1545.0, 1515.0,
                      1513.0, 1477.0, 1476.0, 1460.0, 1447.0, 1433.0, 1369.0, 1319.0],
                     [1738.0, 1703.0, 1633.0, 1601.0, 1567.0, 1563.0, 1547.0, 1494.0, 1469.0, 1453.0, 1452.0, 1438.0,
                      1430.0, 1361.0, 1331.0],
                     [1666.0, 1656.0, 1640.0, 1637.0, 1636.0, 1633.0, 1566.0, 1561.0, 1559.0, 1558.0, 1554.0, 1540.0,
                      1488.0, 1465.0, 1462.0, 1452.0, 1447.0, 1439.0, 1394.0, 1379.0, 1351.0, 1330.0, 1321.0],
                     [1626.0, 1576.0, 1551.0, 1548.0, 1529.0, 1514.0, 1502.0, 1464.0, 1454.0, 1372.0, 1308.0, 1302.0],
                     [1515.0, 1500.0, 1494.0, 1468.0, 1466.0, 1465.0, 1434.0, 1411.0, 1410.0, 1385.0, 1384.0, 1365.0,
                      1343.0, 1317.0, 1254.0],
                     [1775.0, 1759.0, 1757.0, 1750.0, 1749.0, 1712.0, 1708.0, 1706.0, 1665.0, 1640.0, 1639.0, 1617.0,
                      1596.0, 1566.0, 1561.0, 1504.0, 1458.0, 1367.0],
                     [1666.0, 1621.0, 1612.0, 1596.0, 1587.0, 1578.0, 1552.0, 1492.0, 1482.0, 1455.0, 1453.0, 1449.0,
                      1404.0, 1385.0, 1364.0, 1331.0, 1261.0]])

Ants40_x = np.array([[95.4,103.2,103.6,104.4,104.7,105.4,105.6,105.7,107.3,108.0,108.6,108.9,109.0,109.9,110.3],
                     [95.5, 99.5, 100.2, 100.3, 101.0, 102.7, 103.4, 103.5, 103.7, 104.7, 105.2, 105.6, 106.7, 106.8,
                      107.8, 108.3, 109.0, 109.1, 109.8, 111.2],
                     [99.3, 104.5, 104.6, 104.9, 105.2, 105.2, 105.3, 106.3, 107.6, 107.8, 107.8, 109.2, 109.5, 110.0,
                      110.3, 112.6],
                     [100.3, 103.2, 104.0, 104.3, 104.9, 105.6, 107.8, 107.8, 108.4, 109.9, 110.2, 110.4, 110.5, 111.2,
                      111.2, 112.2],
                     [97.2, 99.8, 100.2, 101.4, 101.9, 102.0, 104.2, 104.6, 105.0, 106.6, 106.7, 106.9, 107.4, 107.7,
                      108.5, 108.6, 109.1, 109.1, 110.0, 110.1, 110.2, 112.2, 112.6],
                     [93.3, 95.2, 99.8, 100.5, 102.1, 104.2, 105.8, 106.5, 106.9, 107.0, 107.2, 107.9, 108.7, 110.7],
                     [100.0, 102.4, 102.9, 103.2, 104.4, 104.7, 104.7, 105.2, 105.9, 106.8, 107.7, 107.8, 107.8, 107.9,
                      108.7, 109.3, 109.4, 110.2, 111.5],
                     [99.6, 100.1, 100.5, 101.6, 101.7, 101.8, 102.9, 103.3, 103.9, 104.0, 104.9, 105.5, 105.8, 105.8,
                      105.9, 106.6, 106.9, 107.1, 108.6, 108.6, 108.9],
                     [99.0, 101.6, 103.1, 106.3, 107.1, 107.3, 109.1, 109.5, 109.5, 109.6, 110.3, 110.7, 111.1, 111.1,
                      111.4, 111.8],
                     [100.4, 102.0, 102.4, 103.0, 106.9, 107.2, 107.3, 107.3, 108.6, 108.9, 109.5, 110.4, 110.7, 110.7,
                      111.1]])

Ants40_y = np.array([[1688.0,1658.0,1614.0,1607.0,1581.0,1564.0,1563.0,1546.0,1529.0,1501.0,1483.0,1447.0,1427.0,1423.0,1404.0],
                     [1759.0, 1756.0, 1737.0, 1736.0, 1707.0, 1694.0, 1685.0, 1656.0, 1651.0, 1635.0, 1624.0, 1612.0,
                      1603.0, 1582.0, 1571.0, 1548.0, 1490.0, 1463.0, 1448.0, 1446.0],
                     [1984.0, 1931.0, 1858.0, 1856.0, 1846.0, 1841.0, 1837.0, 1827.0, 1813.0, 1761.0, 1758.0, 1748.0,
                      1735.0, 1705.0, 1618.0, 1579.0],
                     [1661.0, 1638.0, 1623.0, 1621.0, 1612.0, 1605.0, 1600.0, 1546.0, 1539.0, 1526.0, 1474.0, 1432.0,
                      1416.0, 1411.0, 1347.0, 1345.0],
                     [1494.0, 1483.0, 1473.0, 1457.0, 1442.0, 1437.0, 1432.0, 1407.0, 1404.0, 1397.0, 1343.0, 1342.0,
                      1339.0, 1324.0, 1306.0, 1264.0, 1246.0, 1245.0, 1232.0, 1206.0, 1196.0, 1090.0, 1061.0],
                     [1689.0, 1686.0, 1684.0, 1671.0, 1668.0, 1661.0, 1599.0, 1583.0, 1549.0, 1522.0, 1517.0, 1503.0,
                      1498.0, 1414.0],
                     [1696.0, 1683.0, 1650.0, 1639.0, 1637.0, 1632.0, 1584.0, 1580.0, 1573.0, 1546.0, 1523.0, 1512.0,
                      1504.0, 1482.0, 1468.0, 1422.0, 1336.0, 1328.0, 1286.0],
                     [1726.0, 1690.0, 1648.0, 1634.0, 1628.0, 1618.0, 1616.0, 1595.0, 1591.0, 1577.0, 1574.0, 1568.0,
                      1535.0, 1529.0, 1502.0, 1497.0, 1484.0, 1473.0, 1472.0, 1361.0, 1326.0],
                     [1555.0, 1535.0, 1509.0, 1506.0, 1476.0, 1471.0, 1446.0, 1395.0, 1370.0, 1363.0, 1362.0, 1330.0,
                      1313.0, 1299.0, 1209.0, 1201.0],
                     [1787.0, 1755.0, 1736.0, 1734.0, 1725.0, 1632.0, 1626.0, 1620.0, 1619.0, 1603.0, 1576.0, 1555.0,
                      1480.0, 1443.0, 1408.0]])

fig=plt.figure()
for i in range(np.size(Ants2_x,0)):
    plt.plot(Ants2_x[i],Ants2_y[i],marker='+',label=str(i+1),c=Colors[0])
for i in range(np.size(Ants5_x,0)):
    plt.plot(Ants5_x[i],Ants5_y[i],marker='+',label=str(i+1),c=Colors[1])
for i in range(np.size(Ants10_x,0)):
    plt.plot(Ants10_x[i],Ants10_y[i],marker='+',label=str(i+1),c=Colors[2])
for i in range(np.size(Ants20_x,0)):
    plt.plot(Ants20_x[i],Ants20_y[i],marker='+',label=str(i+1),c=Colors[3])
for i in range(np.size(Ants40_x,0)):
    plt.plot(Ants40_x[i],Ants40_y[i],marker='+',label=str(i+1),c=Colors[4])
plt.show()

def oneD(A):
    a = []
    for i in A:
        for j in i:
            a.append(j)
    return np.array(a)

def medianCurve(Eta_x,Eta_y):
    A = oneD(Eta_x)
    B = oneD(Eta_y)
    a = np.array(A,dtype='int')
    U = np.unique(a)

    X = []
    Y = []
    X_err = []
    Y_err = []

    for u in U:
        I = a==u
        N = np.sum(I)
        Ai = A[I]
        Bi = B[I]
        X.append(np.mean(Ai))
        Y.append(np.mean(Bi))
        X_err.append(np.std(Ai)/np.sqrt(N))
        Y_err.append(np.std(Bi)/np.sqrt(N))

    return [X,Y,X_err,Y_err]

[x2,y2,xerr2,yerr2] = medianCurve(Ants2_x,Ants2_y)
[x5,y5,xerr5,yerr5] = medianCurve(Ants5_x,Ants5_y)
[x10,y10,xerr10,yerr10] = medianCurve(Ants10_x,Ants10_y)
[x20,y20,xerr20,yerr20] = medianCurve(Ants20_x,Ants20_y)
[x40,y40,xerr40,yerr40] = medianCurve(Ants40_x,Ants40_y)

plt.figure()
plt.errorbar(x2,y2,xerr=xerr2,yerr=yerr2,label='2',c=Colors[0])
plt.errorbar(x5,y5,xerr=xerr5,yerr=yerr5,label='5',c=Colors[1])
plt.errorbar(x10,y10,xerr=xerr10,yerr=yerr10,label='10',c=Colors[2])
plt.errorbar(x20,y20,xerr=xerr20,yerr=yerr20,label='20',c=Colors[3])
plt.errorbar(x40,y40,xerr=xerr40,yerr=yerr40,label='40',c=Colors[4])
plt.legend()
plt.show()



